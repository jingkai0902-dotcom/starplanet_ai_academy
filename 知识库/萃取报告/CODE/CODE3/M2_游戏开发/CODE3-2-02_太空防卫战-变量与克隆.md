# [CODE3-2-02] 太空防卫战-变量与克隆

> **模块**：M2 游戏开发
> **认知负荷**：高
> **核心技能**：克隆体私有变量、全局变量、碰撞检测
> **UID**：CODE3-M2-02-001

---

## 课程基本信息

| 项目 | 内容 |
|------|------|
| **课程编号** | 3-2-02 |
| **课程名称** | 太空防卫战-变量与克隆 |
| **认知负荷** | 高 |
| **核心技能** | 克隆体私有变量、全局变量、碰撞检测 |
| **所属项目** | 项目一：太空防卫战（第1-3课） |

---

## 详细教学流程

### 步骤1：项目回顾（5分钟）

`#低负荷-热身` `#IFC-预防`

**教师话术**
> "上节课我们做了战机和子弹，今天要加入敌机！敌机会从四面八方飞来，被子弹打中就消失，打中战机游戏就结束！"

---

### 步骤2：任务分析（15分钟）

`#中负荷-操练` `#IFC-即时` ⭐核心环节

**教师话术**
> "敌机的逻辑比较复杂：
>
> 1. **随机出现**：从上、下、左、右四个方向随机出现
> 2. **朝战机飞**：敌机要朝着战机的方向移动
> 3. **碰撞检测**：
>    - 敌机碰到子弹 → 敌机消失，得分+1
>    - 敌机碰到战机 → 游戏结束
>
> 这里有个重要概念：**私有变量**！
>
> 每个敌机克隆体都有自己的'出生方向'，这个变量只属于这个克隆体，叫'私有变量'。
> 而'得分'是所有角色共享的，叫'全局变量'。"

**变体示例**

| 学生情况 | 调整方案 | 说明 |
|----------|----------|------|
| 敌机太多 | 减少生成频率 | 等待时间从1秒改为2秒 |
| 敌机太快 | 降低移动速度 | 从5步改为3步 |
| 混淆私有/全局 | 用盒子类比 | "私有变量是每个人自己的盒子" |

**核心代码模式**
```
// 敌机生成（敌机角色脚本）
当绿旗被点击
隐藏
重复执行
  等待 (在 1 到 2 之间取随机数) 秒
  克隆 [自己]
结束

// 敌机克隆体行为
当作为克隆体启动时
将 [出生方向] 设为 (在 1 到 4 之间取随机数)  // 私有变量
如果 <(出生方向) = (1)> 那么
  移到 x: (在 -200 到 200 之间取随机数) y: (180)  // 从上方
结束
如果 <(出生方向) = (2)> 那么
  移到 x: (在 -200 到 200 之间取随机数) y: (-180) // 从下方
结束
如果 <(出生方向) = (3)> 那么
  移到 x: (-240) y: (在 -150 到 150 之间取随机数) // 从左方
结束
如果 <(出生方向) = (4)> 那么
  移到 x: (240) y: (在 -150 到 150 之间取随机数)  // 从右方
结束
显示
重复执行
  面向 [战机] 方向
  移动 (3) 步
  如果 <碰到 [子弹] ?> 那么
    将 [得分] 增加 (1)  // 全局变量
    删除此克隆体
  结束
  如果 <碰到 [战机] ?> 那么
    广播 [游戏结束]
    删除此克隆体
  结束
结束
```

**禁忌提醒**
- 不要把私有变量设为"适用于所有角色"——会导致所有敌机行为相同
- 不要忘记删除克隆体——会导致内存溢出

---

## 核心知识点

- 私有变量：只属于当前克隆体的变量
- 全局变量：所有角色共享的变量
- 碰撞检测：检测两个角色是否接触
- 随机生成：用随机数决定出现位置

---

## 导航

- **上一课**：[CODE3-2-01 太空防卫战-基础功能](CODE3-2-01_太空防卫战-基础功能.md)
- **下一课**：[CODE3-2-03 太空防卫战-大招与平衡](CODE3-2-03_太空防卫战-大招与平衡.md)
- **模块概览**：[M2 游戏开发](_模块概览.md)

---

`#执行层` `#测评项`
[UID: CODE3-M2-02-001]
