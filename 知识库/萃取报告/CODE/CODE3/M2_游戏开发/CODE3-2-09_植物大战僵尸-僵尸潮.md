# [CODE3-2-09] 植物大战僵尸-僵尸潮

> **模块**：M2 游戏开发
> **认知负荷**：高
> **核心技能**：列表(List)应用、波次系统、胜负判定
> **UID**：CODE3-M2-09-001

---

## 课程基本信息

| 项目 | 内容 |
|------|------|
| **课程编号** | 3-2-09 |
| **课程名称** | 植物大战僵尸-僵尸潮 |
| **认知负荷** | 高 |
| **核心技能** | 列表(List)应用、波次系统、胜负判定 |
| **所属项目** | 项目三：植物大战僵尸（第7-9课） |

---

## 详细教学流程

### 步骤1：项目回顾（5分钟）

`#低负荷-热身` `#IFC-预防`

**教师话术**
> "我们已经有了阳光、植物、豌豆，今天要加入最重要的敌人——僵尸！而且不是一个僵尸，是一波一波的僵尸潮！"

---

### 步骤2：任务分析（15分钟）

`#中负荷-操练` `#IFC-即时` ⭐核心环节

**教师话术**
> "僵尸潮的设计需要用到'列表'！
>
> 什么是列表？就像一排小格子，每个格子存一个数据：
> - 列表[僵尸血量]：记录每个僵尸还有多少血
> - 列表[僵尸行号]：记录每个僵尸在哪一行
>
> 波次系统：
> - 第1波：3个普通僵尸
> - 第2波：5个普通僵尸
> - 第3波：3个普通僵尸 + 2个铁桶僵尸
>
> 胜负判定：
> - 胜利：所有波次的僵尸都被消灭
> - 失败：任何一个僵尸走到最左边"

**变体示例**

| 学生情况 | 调整方案 | 说明 |
|----------|----------|------|
| 列表概念困难 | 用抽屉类比 | "每个抽屉放一个僵尸的信息" |
| 僵尸太强 | 减少血量 | 普通僵尸从3血改为2血 |
| 想增加难度 | 添加僵尸类型 | 路障僵尸、铁桶僵尸 |

**核心代码模式**
```
// 僵尸生成系统
当绿旗被点击
删除 [僵尸列表] 的全部项目
将 [当前波次] 设为 (1)
将 [本波僵尸数] 设为 (3)
将 [已生成数] 设为 (0)
广播 [开始波次]

当收到 [开始波次]
重复 (本波僵尸数) 次
  等待 (在 2 到 5 之间取随机数) 秒
  克隆 [僵尸]
  将 [已生成数] 增加 (1)
结束

// 僵尸克隆体行为
当作为克隆体启动时
将 [我的血量] 设为 (3)
将 [我的行号] 设为 (在 0 到 4 之间取随机数)
// 添加到列表
将 (我的血量) 加入 [僵尸血量列表]
将 (我的行号) 加入 [僵尸行号列表]
// 移动到对应行
移到 x: (240) y: (100 - (我的行号) * 60 - 30)
显示
重复执行
  将 x 增加 (-1)  // 向左移动
  // 检测是否被豌豆击中
  如果 <碰到 [豌豆] ?> 那么
    将 [我的血量] 增加 (-1)
    如果 <(我的血量) <= (0)> 那么
      将 [击杀数] 增加 (1)
      删除此克隆体
    结束
  结束
  // 检测是否到达终点
  如果 <(x) < (-220)> 那么
    广播 [游戏失败]
    停止 [全部]
  结束
结束

// 胜利判定
当绿旗被点击
等待直到 <<(当前波次) > (3)> 且 <(击杀数) = (总僵尸数)>>
广播 [游戏胜利]
```

---

### 步骤3：家长班会（10分钟）

`#低负荷-热身` `#IFC-复盘`

**教师话术**
> "各位家长大家好！植物大战僵尸项目完成了！三节课下来，孩子们学会了：
> 1. **阳光系统**：资源收集与管理
> 2. **网格对齐**：坐标计算与取整
> 3. **射线检测**：智能攻击判断
> 4. **列表应用**：批量数据管理
> 5. **波次系统**：游戏难度设计
>
> 这是一个完整的塔防游戏，涉及了很多高级编程概念！"

---

## 核心知识点

- 列表(List)：存储多个数据的数据结构
- 波次系统：分批生成敌人，控制难度曲线
- 胜负判定：检测游戏结束条件

---

## 底层逻辑

- **数据结构**：列表是管理批量数据的基础
- **游戏设计**：波次系统控制游戏节奏
- **状态管理**：用变量和列表记录游戏状态

---

## 导航

- **上一课**：[CODE3-2-08 植物大战僵尸-射手与子弹](CODE3-2-08_植物大战僵尸-射手与子弹.md)
- **下一课**：[CODE3-2-10 勇闯黑白岛-重力引擎](CODE3-2-10_勇闯黑白岛-重力引擎.md)
- **模块概览**：[M2 游戏开发](_模块概览.md)

---

`#执行层` `#测评项`
[UID: CODE3-M2-09-001]
