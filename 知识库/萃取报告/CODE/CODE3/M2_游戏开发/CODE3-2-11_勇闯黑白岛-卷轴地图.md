# [CODE3-2-11] 勇闯黑白岛-卷轴地图

> **模块**：M2 游戏开发
> **认知负荷**：高
> **核心技能**：相对坐标、背景滚动、视差效果
> **UID**：CODE3-M2-11-001

---

## 课程基本信息

| 项目 | 内容 |
|------|------|
| **课程编号** | 3-2-11 |
| **课程名称** | 勇闯黑白岛-卷轴地图 |
| **认知负荷** | 高 |
| **核心技能** | 相对坐标、背景滚动、视差效果 |
| **所属项目** | 项目四：勇闯黑白岛（第10-12课） |

---

## 详细教学流程

### 步骤1：项目回顾（5分钟）

`#低负荷-热身` `#IFC-预防`

**教师话术**
> "上节课我们做了重力引擎，小白可以跳跃了！但是地图只有一个屏幕大小，太小了！今天我们要让地图变得无限大——用卷轴地图技术！"

---

### 步骤2：任务分析（15分钟）

`#中负荷-操练` `#IFC-即时` ⭐核心环节

**教师话术**
> "什么是卷轴地图？想象一下古代的卷轴画，画很长，但你只能看到展开的那一部分。
>
> 卷轴地图的原理：
> - 主角始终在屏幕中央
> - 按右键时，不是主角向右走，而是背景向左移动
> - 看起来就像主角在前进！
>
> 这就是'相对运动'——你坐在火车上，看窗外的树在往后跑，其实是你在往前走！
>
> 我们还要做'视差效果'：
> - 远处的山移动慢
> - 近处的树移动快
> - 这样看起来更有立体感！"

**变体示例**

| 学生情况 | 调整方案 | 说明 |
|----------|----------|------|
| 不理解相对运动 | 用火车类比 | "坐火车时树往后跑" |
| 背景移动卡顿 | 减少背景数量 | 先用一层背景 |
| 想增加效果 | 添加云朵层 | 云朵移动最慢 |

**核心代码模式**
```
// 主角控制（保持在屏幕中央）
当绿旗被点击
移到 x: (0) y: (-50)  // 屏幕中央偏下
重复执行
  // 主角不移动X坐标，只处理跳跃
  如果 <按下 [上移] 键?> 那么
    如果 <碰到 [黑色] ?> 那么  // 在地面上才能跳
      将 [Y速度] 设为 (12)
    结束
  结束
  // 重力
  将 [Y速度] 增加 (-1)
  将 y 增加 (Y速度)
  如果 <碰到 [黑色] ?> 那么
    将 [Y速度] 设为 (0)
    将 y 增加 (1)  // 微调防止陷入
  结束
结束

// 背景滚动（背景角色脚本）
当绿旗被点击
重复执行
  如果 <按下 [右移] 键?> 那么
    将 x 增加 (-5)  // 背景向左移动
    广播 [向右移动]
  结束
  如果 <按下 [左移] 键?> 那么
    将 x 增加 (5)   // 背景向右移动
    广播 [向左移动]
  结束
  // 背景循环：当背景移出屏幕时，移到另一边
  如果 <(x) < (-480)> 那么
    将 x 增加 (960)
  结束
  如果 <(x) > (480)> 那么
    将 x 增加 (-960)
  结束
结束

// 视差效果（远景角色，移动更慢）
当绿旗被点击
重复执行
  如果 <按下 [右移] 键?> 那么
    将 x 增加 (-2)  // 远景移动慢
  结束
  如果 <按下 [左移] 键?> 那么
    将 x 增加 (2)
  结束
结束
```

**禁忌提醒**
- 不要让主角X坐标改变——会破坏卷轴效果
- 不要忘记背景循环——否则背景会移出屏幕

---

### 步骤3：地图拼接（15分钟）

`#高负荷-产出` `#IFC-即时`

**教师话术**
> "一张背景图不够长怎么办？我们用多张背景拼接！
>
> 技巧：
> 1. 准备2-3张背景图，首尾能衔接
> 2. 把它们排成一排
> 3. 当第一张移出屏幕时，移到最后面
>
> 这样就能实现无限循环的地图！"

---

## 核心知识点

- 卷轴地图：主角保持屏幕中心，背景移动
- 相对坐标：背景移动而非角色移动
- 视差效果：不同层移动速度不同，产生立体感
- 背景循环：背景移出屏幕后移到另一边

---

## 底层逻辑

- **相对运动**：参照物不同，运动描述不同
- **视觉欺骗**：用背景移动模拟角色移动

---

## 导航

- **上一课**：[CODE3-2-10 勇闯黑白岛-重力引擎](CODE3-2-10_勇闯黑白岛-重力引擎.md)
- **下一课**：[CODE3-2-12 勇闯黑白岛-交互与AI](CODE3-2-12_勇闯黑白岛-交互与AI.md)
- **模块概览**：[M2 游戏开发](_模块概览.md)

---

`#执行层` `#测评项`
[UID: CODE3-M2-11-001]
