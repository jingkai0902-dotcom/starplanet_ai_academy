# [PYAI-2-2-07] 积小致巨1

> **模块**：L2-M2 项目应用
> **认知负荷**：高
> **核心技能**：按键交互、碰撞检测、列表动态操作
> **UID**：PYAI-22-07-001

---

## 课程基本信息

| 项目 | 内容 |
|------|------|
| **课程编号** | 2-2-7 |
| **课程名称** | 积小致巨1 |
| **认知负荷** | 高 |
| **核心技能** | 按键交互、碰撞检测、列表动态操作 |

---

## 详细教学流程

**步骤1：知识讲解（20分钟）** `#中负荷-操练` `#IFC-即时`

**教师话术**
> "今天我们做一个**球球大作战**游戏！玩家控制一个球，吃掉小球变大，碰到大球就游戏结束。"
>
> "**按键交互**：用键盘控制角色移动
> ```python
> keys = pygame.key.get_pressed()
> if keys[pygame.K_LEFT]:
>     player_x -= speed
> if keys[pygame.K_RIGHT]:
>     player_x += speed
> if keys[pygame.K_UP]:
>     player_y -= speed
> if keys[pygame.K_DOWN]:
>     player_y += speed
> ```
>
> **碰撞检测**：判断两个圆是否相交
> ```python
> def check_collision(x1, y1, r1, x2, y2, r2):
>     distance = math.sqrt((x1-x2)**2 + (y1-y2)**2)
>     return distance < r1 + r2  # 距离小于半径之和就碰撞
> ```"

---

## 核心代码模式

```python
import pygame
import random
import math

pygame.init()
screen = pygame.display.set_mode((800, 600))

# 玩家
player_x, player_y = 400, 300
player_radius = 20
speed = 5

# 食物球列表
foods = []
for _ in range(20):
    foods.append({
        'x': random.randint(50, 750),
        'y': random.randint(50, 550),
        'radius': random.randint(5, 15),
        'color': (random.randint(50,255), random.randint(50,255), random.randint(50,255))
    })

def check_collision(x1, y1, r1, x2, y2, r2):
    distance = math.sqrt((x1-x2)**2 + (y1-y2)**2)
    return distance < r1 + r2

running = True
while running:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False

    # 按键控制
    keys = pygame.key.get_pressed()
    if keys[pygame.K_LEFT]: player_x -= speed
    if keys[pygame.K_RIGHT]: player_x += speed
    if keys[pygame.K_UP]: player_y -= speed
    if keys[pygame.K_DOWN]: player_y += speed

    # 边界限制
    player_x = max(player_radius, min(800-player_radius, player_x))
    player_y = max(player_radius, min(600-player_radius, player_y))

    # 碰撞检测
    for food in foods[:]:  # 用切片复制列表，避免遍历时修改
        if check_collision(player_x, player_y, player_radius,
                          food['x'], food['y'], food['radius']):
            if player_radius > food['radius']:
                # 吃掉小球，变大
                player_radius += food['radius'] // 3
                foods.remove(food)

    screen.fill((30, 30, 30))

    # 绘制食物
    for food in foods:
        pygame.draw.circle(screen, food['color'], (food['x'], food['y']), food['radius'])

    # 绘制玩家
    pygame.draw.circle(screen, (0, 255, 0), (int(player_x), int(player_y)), player_radius)

    pygame.display.flip()
    pygame.time.delay(16)

pygame.quit()
```

---

## 变体示例

| 学生情况 | 调整方案 | 说明 |
|----------|----------|------|
| 移动太快/太慢 | 调整speed | 根据手感调整移动速度 |
| 想加敌人 | 添加AI球 | 敌人球会追踪玩家 |
| 碰撞不准 | 检查半径 | 确保碰撞检测使用正确的半径 |

---

## 禁忌提醒

- ❌ 遍历列表时直接删除元素——会跳过元素，用切片复制
- ❌ 忘记边界限制——球会跑出屏幕

---

## 核心知识点

- 按键交互：`pygame.key.get_pressed()`
- 碰撞检测：圆形碰撞（距离 < 半径之和）
- 列表动态操作：遍历时安全删除元素

---

`#执行层` `#测评项`
[UID: PYAI-22-07-001]

---

[上一课](PYAI-2-2-06_弱肉强食.md) | [下一课](PYAI-2-2-08_积小致巨2.md) | [返回模块概览](_模块概览.md)
