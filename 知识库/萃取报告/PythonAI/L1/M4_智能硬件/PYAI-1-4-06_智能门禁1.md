# [PYAI-1-4-06] 智能门禁(1) - 人脸捕捉相机

> **模块**：L1-M4 智能硬件
> **认知负荷**：高
> **核心技能**：AI视觉基础、cv2.VideoCapture
> **UID**：PYAI-14-06-001

---

## 课程基本信息

| 项目 | 内容 |
|------|------|
| **课程编号** | PYAI-1-4-06 |
| **课程名称** | 智能门禁(1) - 人脸捕捉相机 |
| **认知负荷** | 高 |
| **核心技能** | AI视觉基础、cv2.VideoCapture |
| **课时** | 90分钟 |
| **系列** | 智能门禁三部曲（1/3） |

---

## 详细教学流程

### 步骤1：课程导入（5分钟）

`#低负荷-热身` `#IFC-预防`

**教师话术**
> "同学们，今天我们开始做智能门禁系统！第一步是让电脑'看见'人脸。这是AI视觉的入门——让计算机拥有'眼睛'！"

---

### 步骤2：知识讲解（15分钟）

`#中负荷-操练` `#IFC-即时`

**教师话术**
> "我们用**OpenCV**库来控制摄像头。OpenCV是计算机视觉领域最流行的库。
>
> **基本流程**：
> 1. 打开摄像头
> 2. 读取图像帧
> 3. 显示图像
> 4. 释放摄像头
>
> ```python
> import cv2
>
> # 打开摄像头（0表示第一个摄像头）
> cap = cv2.VideoCapture(0)
>
> # 读取一帧图像
> ret, frame = cap.read()
> # ret: 是否成功读取（True/False）
> # frame: 图像数据（numpy数组）
>
> # 显示图像
> cv2.imshow('Camera', frame)
>
> # 等待按键
> cv2.waitKey(0)
>
> # 释放摄像头
> cap.release()
> cv2.destroyAllWindows()
> ```"

**核心代码模式**

```python
import cv2

# 打开摄像头
cap = cv2.VideoCapture(0)

# 检查摄像头是否打开成功
if not cap.isOpened():
    print("无法打开摄像头")
    exit()

while True:
    # 读取一帧
    ret, frame = cap.read()

    if not ret:
        print("无法读取图像")
        break

    # 显示图像
    cv2.imshow('Camera', frame)

    # 按'q'键退出
    if cv2.waitKey(1) & 0xFF == ord('q'):
        break

# 释放资源
cap.release()
cv2.destroyAllWindows()
```

**变体示例**

| 学生情况 | 调整方案 | 说明 |
|----------|----------|------|
| 摄像头打不开 | 检查设备 | 确认摄像头没被其他程序占用 |
| 图像是黑的 | 检查权限 | 可能需要授权摄像头访问 |
| 想保存照片 | 使用imwrite | `cv2.imwrite('photo.jpg', frame)` |

---

### 步骤3：硬件准备（20分钟）

`#高负荷-产出` `#IFC-即时`

**教师话术**
> "今天使用电脑自带的摄像头或USB摄像头。
>
> **检查步骤**：
> 1. 确认摄像头已连接
> 2. 在设备管理器中查看是否识别
> 3. 关闭其他可能占用摄像头的程序（如QQ、微信视频）
>
> **摄像头参数**：
> ```python
> # 设置分辨率
> cap.set(cv2.CAP_PROP_FRAME_WIDTH, 640)
> cap.set(cv2.CAP_PROP_FRAME_HEIGHT, 480)
>
> # 获取当前分辨率
> width = cap.get(cv2.CAP_PROP_FRAME_WIDTH)
> height = cap.get(cv2.CAP_PROP_FRAME_HEIGHT)
> print(f'分辨率: {width}x{height}')
> ```"

**禁忌提醒**

❌ **忘记释放摄像头**——程序结束前必须调用 `cap.release()`
❌ **摄像头被占用**——确保没有其他程序在使用摄像头
❌ **无限循环没有退出条件**——必须有按键退出机制

---

### 步骤4：编程调试（30分钟）

`#高负荷-产出` `#IFC-即时`

**教师话术**
> "现在我们来实现**拍照功能**：
>
> ```python
> import cv2
>
> cap = cv2.VideoCapture(0)
> photo_count = 0
>
> while True:
>     ret, frame = cap.read()
>     if not ret:
>         break
>
>     # 在画面上显示提示
>     cv2.putText(frame, 'Press S to save, Q to quit',
>                 (10, 30), cv2.FONT_HERSHEY_SIMPLEX,
>                 0.7, (0, 255, 0), 2)
>
>     cv2.imshow('Camera', frame)
>
>     key = cv2.waitKey(1) & 0xFF
>     if key == ord('s'):
>         # 保存照片
>         filename = f'photo_{photo_count}.jpg'
>         cv2.imwrite(filename, frame)
>         print(f'已保存: {filename}')
>         photo_count += 1
>     elif key == ord('q'):
>         break
>
> cap.release()
> cv2.destroyAllWindows()
> ```
>
> 按S键拍照，按Q键退出。试试看！"

**变体示例**

| 学生情况 | 调整方案 | 说明 |
|----------|----------|------|
| 按键没反应 | 检查窗口焦点 | 确保OpenCV窗口是当前活动窗口 |
| 想加滤镜 | 图像处理 | 可以加灰度、模糊等效果 |
| 想录视频 | 使用VideoWriter | 保存为视频文件 |

---

### 步骤5：成果展示（10分钟）

`#低负荷-热身` `#IFC-复盘`

**教师话术**
> "谁的摄像头程序做好了？展示一下你拍的照片！
>
> 下节课我们将学习如何让电脑'认识'人脸——人脸比对算法！"

---

## 核心知识点

- OpenCV摄像头控制：`cv2.VideoCapture(0)`
- 读取图像帧：`cap.read()` 返回 (ret, frame)
- 显示图像：`cv2.imshow('窗口名', frame)`
- 资源释放：`cap.release()` + `cv2.destroyAllWindows()`

---

## 底层逻辑

- **AI视觉流程**：采集 → 处理 → 输出
- **实时处理**：循环读取帧，实现视频效果

---

`#执行层` `#测评项`
[UID: PYAI-14-06-001]

---

[上一课](PYAI-1-4-05_智能通风.md) | [返回模块](_模块概览.md) | [下一课](PYAI-1-4-07_智能门禁2.md)
