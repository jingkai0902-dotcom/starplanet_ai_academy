# [PYAI-1-4-03] 智能光控(1) - 光控灯搭建

> **模块**：L1-M4 智能硬件
> **认知负荷**：中-高
> **核心技能**：mpython_conn库、LED/RGB控制、光线传感器
> **UID**：PYAI-14-03-001

---

## 课程基本信息

| 项目 | 内容 |
|------|------|
| **课程编号** | PYAI-1-4-03 |
| **课程名称** | 智能光控(1) - 光控灯搭建 |
| **认知负荷** | 中-高 |
| **核心技能** | mpython_conn库、LED/RGB控制、光线传感器 |
| **课时** | 90分钟 |

---

## 详细教学流程

### 步骤1：课程回顾（5分钟）

`#低负荷-热身` `#IFC-预防`

**教师话术**
> "上节课我们认识了ESP32开发板。今天我们要连接第一个外部传感器——**光线传感器**！它能感知环境的亮度。"

---

### 步骤2：知识讲解（15分钟）

`#中负荷-操练` `#IFC-即时`

**教师话术**
> "**光线传感器**的工作原理：
> - 内部有一个光敏电阻
> - 光线越强，电阻越小，输出值越大
> - 光线越弱，电阻越大，输出值越小
>
> **RGB灯**可以显示任意颜色：
> ```python
> from mpython import *
>
> # RGB灯控制 - 三个参数分别是红、绿、蓝（0-255）
> rgb[0] = (255, 0, 0)    # 红色
> rgb[1] = (0, 255, 0)    # 绿色
> rgb[2] = (0, 0, 255)    # 蓝色
> rgb.write()             # 更新显示
> ```
>
> **颜色混合**：
> - (255, 255, 0) = 黄色（红+绿）
> - (255, 0, 255) = 紫色（红+蓝）
> - (0, 255, 255) = 青色（绿+蓝）
> - (255, 255, 255) = 白色"

**核心代码模式**

```python
from mpython import *
import time

# 读取光线传感器
light_value = light.read()
print(f"当前光线值: {light_value}")

# 控制RGB灯
rgb[0] = (255, 100, 0)  # 橙色
rgb.write()

# 关闭RGB灯
rgb.fill((0, 0, 0))
rgb.write()
```

**变体示例**

| 学生情况 | 调整方案 | 说明 |
|----------|----------|------|
| 不理解RGB | 用调色盘类比 | "红绿蓝三种颜料混合" |
| 颜色不对 | 检查参数顺序 | 顺序是(红, 绿, 蓝) |
| 忘记write() | 强调更新 | "设置颜色后必须write()才生效" |

---

### 步骤3：硬件搭建（20分钟）

`#高负荷-产出` `#IFC-即时`

**教师话术**
> "今天我们使用板载的光线传感器，不需要额外接线！
>
> 但如果使用外部光线传感器模块，接线方式是：
> ```
> VCC → 3.3V（红线）
> GND → GND（黑线）
> OUT → P0（信号线）
> ```
>
> **接线口诀**：红接红，黑接黑，信号线接P引脚。"

**禁忌提醒**

❌ **接反VCC和GND**——会烧毁传感器
❌ **信号线接错引脚**——读取不到数据
❌ **带电插拔**——可能损坏接口

---

### 步骤4：编程调试（30分钟）

`#高负荷-产出` `#IFC-即时`

**教师话术**
> "现在我们来写一个光控灯程序：
>
> ```python
> from mpython import *
> import time
>
> while True:
>     # 读取光线值
>     light_value = light.read()
>     print(f'光线值: {light_value}')
>
>     # 根据光线调整RGB亮度
>     brightness = int(light_value / 16)  # 0-4095 映射到 0-255
>     rgb.fill((brightness, brightness, brightness))
>     rgb.write()
>
>     time.sleep(0.1)
> ```
>
> 用手遮住光线传感器，观察RGB灯的变化！"

**变体示例**

| 学生情况 | 调整方案 | 说明 |
|----------|----------|------|
| 灯不变化 | 检查传感器 | 用print确认light.read()有变化 |
| 想要彩色效果 | 修改RGB参数 | 根据光线值改变颜色而非亮度 |
| 变化太快 | 增加延时 | 把sleep改成0.5秒 |

---

### 步骤5：成果展示（10分钟）

`#低负荷-热身` `#IFC-复盘`

**教师话术**
> "谁能让RGB灯根据光线变化显示不同颜色？比如：
> - 光线强 → 蓝色（白天）
> - 光线弱 → 橙色（傍晚）
> - 很暗 → 红色（夜晚）"

---

## 核心知识点

- 光线传感器：`light.read()` 返回0-4095
- RGB灯控制：`rgb[n] = (R, G, B)` + `rgb.write()`
- 颜色混合：红+绿=黄，红+蓝=紫，绿+蓝=青

---

## 底层逻辑

- **传感器输入**：环境信息 → 数字信号
- **执行器输出**：数字信号 → 物理效果

---

`#执行层` `#测评项`
[UID: PYAI-14-03-001]

---

[上一课](PYAI-1-4-02_按钮控制LED.md) | [返回模块](_模块概览.md) | [下一课](PYAI-1-4-04_智能光控2.md)
