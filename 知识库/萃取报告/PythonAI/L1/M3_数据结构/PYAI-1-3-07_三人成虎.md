# [PYAI-1-3-07] 三人成虎

> **模块**：L1-M3 数据结构
> **认知负荷**：高
> **核心技能**：二维列表进阶、模式识别
> **UID**：PYAI-13-07-001

---

## 课程基本信息

| 项目 | 内容 |
|------|------|
| **课程编号** | PYAI-1-3-07 |
| **课程名称** | 三人成虎 |
| **认知负荷** | 高 |
| **核心技能** | 二维列表进阶、模式识别 |
| **项目内容** | 三消逻辑 |

---

## 详细教学流程

### 步骤1：知识讲解（20分钟）

`#中负荷-操练` `#IFC-即时`

**教师话术**

> "上节课我们学了二维列表表示棋盘，今天来学习如何在二维列表中**识别模式**——比如三消游戏中的'三个连在一起'！"
>
> "**横向检测**：检查同一行是否有三个连续相同
> ```python
> board = [
>     [1, 1, 1, 0, 2],
>     [0, 2, 2, 2, 0],
>     [1, 0, 1, 0, 1]
> ]
>
> # 检测第一行是否有三连
> for col in range(3):  # 只需检查到倒数第3个
>     if board[0][col] == board[0][col+1] == board[0][col+2]:
>         if board[0][col] != 0:  # 0表示空
>             print(f'发现三连！位置: 行0, 列{col}到{col+2}')
> ```
>
> **纵向检测**：检查同一列是否有三个连续相同
> ```python
> # 检测第一列是否有三连
> for row in range(len(board) - 2):
>     if board[row][0] == board[row+1][0] == board[row+2][0]:
>         if board[row][0] != 0:
>             print(f'发现三连！位置: 列0, 行{row}到{row+2}')
> ```
>
> **完整扫描**：遍历整个棋盘
> ```python
> def check_horizontal(board):
>     matches = []
>     for row in range(len(board)):
>         for col in range(len(board[row]) - 2):
>             if board[row][col] == board[row][col+1] == board[row][col+2]:
>                 if board[row][col] != 0:
>                     matches.append((row, col))
>     return matches
> ```"

---

### 步骤2：闯关实践（35分钟）

`#高负荷-产出` `#IFC-即时`

**教师话术**

> "现在来实现三消游戏的核心逻辑！检测棋盘中所有的三连，并把它们消除（设为0）。"
>
> ```python
> board = [
>     [1, 2, 2, 2, 1],
>     [1, 1, 1, 0, 2],
>     [2, 0, 1, 0, 1]
> ]
>
> # 检测并消除横向三连
> for row in range(len(board)):
>     for col in range(len(board[row]) - 2):
>         if board[row][col] == board[row][col+1] == board[row][col+2]:
>             if board[row][col] != 0:
>                 print(f'消除: 行{row}, 列{col}到{col+2}')
>                 board[row][col] = 0
>                 board[row][col+1] = 0
>                 board[row][col+2] = 0
>
> # 打印消除后的棋盘
> for row in board:
>     print(row)
> ```

---

### 步骤3：项目创作（15分钟）

`#高负荷-产出` `#IFC-即时`

**教师话术**

> "挑战：同时检测横向和纵向的三连！"
>
> ```python
> def find_all_matches(board):
>     matches = []
>     # 横向检测
>     for row in range(len(board)):
>         for col in range(len(board[row]) - 2):
>             if board[row][col] == board[row][col+1] == board[row][col+2] != 0:
>                 matches.append(('H', row, col))
>     # 纵向检测
>     for row in range(len(board) - 2):
>         for col in range(len(board[row])):
>             if board[row][col] == board[row+1][col] == board[row+2][col] != 0:
>                 matches.append(('V', row, col))
>     return matches
> ```

---

## 变体示例

| 学生情况 | 调整方案 | 说明 |
|----------|----------|------|
| 边界条件混乱 | 画图演示 | "为什么col只能到len-2？因为还要检查col+1和col+2" |
| 连续比较不理解 | 拆分写法 | "a == b == c 等价于 a == b and b == c" |
| 想做完整游戏 | 引导扩展 | "消除后如何让上面的方块掉下来？" |

---

## 核心知识点

- **模式识别**：在二维数组中检测连续相同元素
- **边界处理**：遍历时注意不要越界（len-2）
- **连续比较**：`a == b == c` 检测三个值相等
- **坐标记录**：用元组记录匹配位置

---

`#执行层` `#测评项`

---

## 导航

- **上一课**：[PYAI-1-3-06 落子无悔](PYAI-1-3-06_落子无悔.md)
- **下一课**：[PYAI-1-3-08 出口成章](PYAI-1-3-08_出口成章.md)
- **返回模块**：[M3 数据结构概览](_模块概览.md)
