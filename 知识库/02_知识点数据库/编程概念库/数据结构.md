# 数据结构

> **用途**：跨课程数据结构（列表、字典、二维数组）详细说明
> **更新日期**：2026-02-10
> **数据来源**：萃取报告/CODE/、萃取报告/PythonAI/
> **整合原则**：基于现有萃取报告，不压缩删减

---

## 一、列表 (List)

### 概念定义
列表是存储多个数据的有序容器，可以存放不同类型的数据，支持增删改查操作。

### 跨课程出现

| 课程编号 | 课程名称 | 具体内容 |
|----------|---------|---------|
| CODE2-3-10 | 列表(数组) | 存储多个数据的容器 |
| PYAI 1-3-1 | 列表定义 | `fruits = ['apple', 'banana']` |
| PYAI 1-3-2 | append()添加 | 动态列表 |
| PYAI 1-3-3 | len()函数 | 通用遍历 |
| PYAI 1-3-4 | 列表进阶 | insert/pop/remove/sort |

---

### 1.1 列表定义与访问

#### Scratch示例
```
创建列表 [水果列表 v]
添加 [苹果] 到 [水果列表 v]
添加 [香蕉] 到 [水果列表 v]
说 ([水果列表 v] 的第 (1) 项)
```

#### Python示例
```python
# 列表定义
fruits = ['apple', 'banana', 'cherry']
numbers = [1, 2, 3, 4, 5]
mixed = [1, 'hello', 3.14, True]  # 可以混合类型

# 访问元素（索引从0开始）
first = fruits[0]      # 'apple'
second = fruits[1]     # 'banana'
last = fruits[-1]      # 'cherry'（负索引从末尾开始）

# 列表长度
count = len(fruits)    # 3
```

### 1.2 列表操作

#### 添加元素

| 方法 | 说明 | 示例 |
|------|------|------|
| `append(item)` | 在末尾添加 | `fruits.append('orange')` |
| `insert(index, item)` | 在指定位置插入 | `fruits.insert(1, 'grape')` |

```python
fruits = ['apple', 'banana']

# 末尾添加
fruits.append('cherry')
# 结果: ['apple', 'banana', 'cherry']

# 指定位置插入
fruits.insert(1, 'grape')
# 结果: ['apple', 'grape', 'banana', 'cherry']
```

#### 删除元素

| 方法 | 说明 | 示例 |
|------|------|------|
| `pop(index)` | 删除指定位置元素并返回 | `fruits.pop(0)` |
| `remove(item)` | 删除第一个匹配的元素 | `fruits.remove('apple')` |

```python
fruits = ['apple', 'banana', 'cherry', 'apple']

# 删除指定位置
removed = fruits.pop(1)  # removed = 'banana'
# 结果: ['apple', 'cherry', 'apple']

# 删除指定值（只删除第一个）
fruits.remove('apple')
# 结果: ['cherry', 'apple']
```

#### 修改元素

```python
fruits = ['apple', 'banana', 'cherry']

# 直接通过索引修改
fruits[1] = 'grape'
# 结果: ['apple', 'grape', 'cherry']
```

#### 查找元素

```python
fruits = ['apple', 'banana', 'cherry']

# 检查元素是否存在
if 'apple' in fruits:
    print("找到了苹果")

# 获取元素索引
index = fruits.index('banana')  # 1
```

### 1.3 列表遍历

#### 跨课程出现

| 课程编号 | 课程名称 | 具体内容 |
|----------|---------|---------|
| PYAI 1-3-1 | while遍历 | `while i < len(fruits):` |
| PYAI 1-3-5 | for遍历 | `for fruit in fruits:` |

#### Python示例
```python
fruits = ['apple', 'banana', 'cherry']

# 方式1: while循环遍历
i = 0
while i < len(fruits):
    print(fruits[i])
    i += 1

# 方式2: for循环遍历（推荐）
for fruit in fruits:
    print(fruit)

# 方式3: 带索引遍历
for i, fruit in enumerate(fruits):
    print(f"{i}: {fruit}")
```

### 1.4 列表排序

#### 跨课程出现

| 课程编号 | 课程名称 | 具体内容 |
|----------|---------|---------|
| PYAI 1-3-4 | sort() | 列表排序 |

#### Python示例
```python
numbers = [3, 1, 4, 1, 5, 9, 2, 6]

# 原地排序（修改原列表）
numbers.sort()
# 结果: [1, 1, 2, 3, 4, 5, 6, 9]

# 降序排序
numbers.sort(reverse=True)
# 结果: [9, 6, 5, 4, 3, 2, 1, 1]

# 不修改原列表的排序
original = [3, 1, 4, 1, 5]
sorted_list = sorted(original)
# original不变，sorted_list是新列表
```

---

## 二、二维列表

### 概念定义
列表中的元素也是列表，形成行列结构，常用于表示棋盘、地图等二维数据。

### 跨课程出现

| 课程编号 | 课程名称 | 具体内容 |
|----------|---------|---------|
| PYAI 1-3-6 | 二维列表 | 嵌套循环遍历 |
| PYAI 1-3-7 | 二维列表进阶 | 模式识别 |
| CODE3-2-07 | 网格对齐 | 将对象对齐到网格 |

### Python示例
```python
# 二维列表定义（3x3棋盘）
board = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
]

# 访问元素
center = board[1][1]  # 5（第2行第2列）
corner = board[0][0]  # 1（第1行第1列）

# 修改元素
board[1][1] = 'X'

# 遍历二维列表
for row in range(3):
    for col in range(3):
        print(board[row][col], end=' ')
    print()  # 换行

# 输出:
# 1 2 3
# 4 X 6
# 7 8 9
```

### 实际应用：井字棋

```python
# 井字棋棋盘
board = [
    [' ', ' ', ' '],
    [' ', ' ', ' '],
    [' ', ' ', ' ']
]

def print_board():
    for row in board:
        print('|'.join(row))
        print('-' * 5)

def check_winner():
    # 检查行
    for row in board:
        if row[0] == row[1] == row[2] != ' ':
            return row[0]

    # 检查列
    for col in range(3):
        if board[0][col] == board[1][col] == board[2][col] != ' ':
            return board[0][col]

    # 检查对角线
    if board[0][0] == board[1][1] == board[2][2] != ' ':
        return board[1][1]
    if board[0][2] == board[1][1] == board[2][0] != ' ':
        return board[1][1]

    return None
```

---

## 三、字典 (Dictionary)

### 概念定义
字典是键值对的集合，通过键（key）来访问对应的值（value），适合存储有关联关系的数据。

### 跨课程出现

| 课程编号 | 课程名称 | 具体内容 |
|----------|---------|---------|
| PYAI 1-2-9 | 字典初识 | 键值对 |
| PYAI 1-3-8 | 字典 | 映射关系 |

### Python示例
```python
# 字典定义
player = {
    'name': '勇士',
    'health': 100,
    'attack': 25,
    'defense': 10
}

# 访问值
name = player['name']      # '勇士'
health = player['health']  # 100

# 安全访问（键不存在时返回默认值）
mana = player.get('mana', 0)  # 0（键不存在）

# 修改值
player['health'] = 80

# 添加新键值对
player['level'] = 5

# 删除键值对
del player['defense']

# 检查键是否存在
if 'attack' in player:
    print(f"攻击力: {player['attack']}")
```

### 字典遍历

```python
player = {'name': '勇士', 'health': 100, 'attack': 25}

# 遍历所有键
for key in player.keys():
    print(key)

# 遍历所有值
for value in player.values():
    print(value)

# 遍历键值对
for key, value in player.items():
    print(f"{key}: {value}")
```

### 实际应用：角色属性

```python
# 游戏角色
characters = {
    'warrior': {'health': 150, 'attack': 30, 'defense': 20},
    'mage': {'health': 80, 'attack': 50, 'defense': 5},
    'archer': {'health': 100, 'attack': 40, 'defense': 10}
}

# 访问特定角色属性
warrior_health = characters['warrior']['health']  # 150

# 遍历所有角色
for name, stats in characters.items():
    print(f"{name}: HP={stats['health']}, ATK={stats['attack']}")
```

---

## 四、列表与字典对比

| 特性 | 列表 (List) | 字典 (Dictionary) |
|------|------------|-------------------|
| 定义 | `[]` | `{}` |
| 访问方式 | 索引 `list[0]` | 键 `dict['key']` |
| 顺序 | 有序 | Python 3.7+有序 |
| 适用场景 | 同类数据集合 | 键值关联数据 |
| 示例 | 分数列表 | 角色属性 |

---

## 五、数据结构进阶路线

```
CODE1-3-10          CODE2-3-10          PYAI 1-3-1          PYAI 1-3-6          PYAI 1-2-9
变量        →       列表         →      列表操作      →     二维列表     →      字典
   ↓                   ↓                   ↓                   ↓                   ↓
 单个值             多个值             增删改查            行列结构            键值对
```

---

## 六、Scratch → Python 映射

| Scratch | Python | 说明 |
|---------|--------|------|
| 创建列表 [列表名] | `list_name = []` | 创建空列表 |
| 添加 (项) 到 [列表] | `list.append(item)` | 添加元素 |
| 删除 [列表] 的第 (1) 项 | `list.pop(0)` | 删除元素 |
| 插入 (项) 到 [列表] 的第 (1) 项 | `list.insert(0, item)` | 插入元素 |
| 替换 [列表] 的第 (1) 项为 (值) | `list[0] = value` | 修改元素 |
| [列表] 的第 (1) 项 | `list[0]` | 访问元素 |
| [列表] 的项目数 | `len(list)` | 列表长度 |
| [列表] 包含 (项)? | `item in list` | 检查存在 |

---

## 七、常见错误与禁忌

| 错误 | 后果 | 正确做法 |
|------|------|---------|
| ❌ 索引越界 | IndexError | 检查索引范围 `if i < len(list)` |
| ❌ 字典访问不存在的键 | KeyError | 使用`get()`或先检查`if key in dict` |
| ❌ 遍历时修改列表 | 跳过元素或报错 | 遍历副本`for item in list[:]` |
| ❌ 混淆索引和值 | 逻辑错误 | 明确是要索引还是值 |
| ❌ 二维列表浅拷贝 | 修改影响原列表 | 使用深拷贝`copy.deepcopy()` |

### 遍历时修改列表的正确方式

```python
# ❌ 错误：遍历时直接删除
numbers = [1, 2, 3, 4, 5]
for num in numbers:
    if num % 2 == 0:
        numbers.remove(num)  # 会跳过元素！

# ✅ 正确：遍历副本
numbers = [1, 2, 3, 4, 5]
for num in numbers[:]:  # 遍历副本
    if num % 2 == 0:
        numbers.remove(num)
# 结果: [1, 3, 5]

# ✅ 正确：列表推导式
numbers = [1, 2, 3, 4, 5]
numbers = [num for num in numbers if num % 2 != 0]
# 结果: [1, 3, 5]
```

---

**维护者**：知识库管理员
**数据来源**：萃取报告/CODE/、萃取报告/PythonAI/
**整合原则**：基于现有萃取报告，不压缩删减
