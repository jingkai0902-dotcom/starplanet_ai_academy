{
  "title": "[PYAI-1-4-08] 智能门禁(3) - 刷脸开门",
  "source": "C:\\Users\\Frank.J\\starplanet_ai_academy\\知识库\\萃取报告\\PythonAI\\L1\\M4_智能硬件\\PYAI-1-4-08_智能门禁3.md",
  "sections": [
    {
      "title": "课程基本信息",
      "content": "| 项目 | 内容 |\n|------|------|\n| **课程编号** | PYAI-1-4-08 |\n| **课程名称** | 智能门禁(3) - 刷脸开门 |\n| **认知负荷** | 高 |\n| **核心技能** | 舵机控制Servo、系统集成 |\n| **课时** | 90分钟 |\n| **系列** | 智能门禁三部曲（3/3） |\n\n---"
    },
    {
      "title": "详细教学流程",
      "content": "### 步骤1：课程回顾（5分钟）\n\n`#低负荷-热身` `#IFC-预防`\n\n**教师话术**\n> \"前两节课我们学会了摄像头采集和人脸比对。今天是最后一步——把AI和硬件连接起来，实现真正的刷脸开门！\"\n\n---\n\n### 步骤2：知识讲解（15分钟）\n\n`#中负荷-操练` `#IFC-即时`\n\n**教师话术**\n> \"**舵机**是一种可以精确控制角度的电机：\n>\n> - 控制范围：0-180度\n> - 用于：门锁、机械臂、云台等\n>\n> **舵机控制原理**：\n> ```python\n> from mpython import *\n>\n> # 舵机连接到P0引脚\n> servo = Servo(Pin.P0)\n>\n> # 控制角度\n> servo.write_angle(0)    # 转到0度（关门）\n> servo.write_angle(90)   # 转到90度（开门）\n> servo.write_angle(180)  # 转到180度\n> ```\n>\n> **系统集成流程**：\n> ```\n> 摄像头采集 → 人脸比对 → 相似度判断 → 舵机控制\n>      ↓            ↓           ↓           ↓\n>    frame      similarity   > 0.8?     开门/拒绝\n> ```\"\n\n**核心代码模式**\n\n```python\nimport cv2\nfrom mpython import *\nimport time\n\n# 初始化舵机\nservo = Servo(Pin.P0)\nservo.write_angle(0)  # 初始位置（关门）\n\n# 加载人脸模板\ntemplate = cv2.imread('my_face.jpg', cv2.IMREAD_GRAYSCALE)\ntemplate = cv2.resize(template, (100, 100))\n\n# 打开摄像头\ncap = cv2.VideoCapture(0)\n\n# 匹配阈值\nTHRESHOLD = 0.8\n\nwhile True:\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # 转灰度并调整大小\n    gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)\n    gray_resized = cv2.resize(gray, (100, 100))\n\n    # 计算相似度\n    result = cv2.matchTemplate(gray_resized, template, cv2.TM_CCOEFF_NORMED)\n    similarity = result[0][0]\n\n    # 判断并控制舵机\n    if similarity > THRESHOLD:\n        print(f'匹配成功！相似度: {similarity:.2f}')\n        servo.write_angle(90)  # 开门\n        rgb.fill((0, 255, 0))  # 绿灯\n        rgb.write()\n        time.sleep(3)          # 保持3秒\n        servo.write_angle(0)   # 关门\n        rgb.fill((0, 0, 0))\n        rgb.write()\n    else:\n        rgb.fill((255, 0, 0))  # 红灯\n        rgb.write()\n\n    # 显示画面\n    cv2.imshow('Smart Door', frame)\n    if cv2.waitKey(1) & 0xFF == ord('q'):\n        break\n\ncap.release()\ncv2.destroyAllWindows()\n```\n\n**变体示例**\n\n| 学生情况 | 调整方案 | 说明 |\n|----------|----------|------|\n| 舵机不动 | 检查接线 | 确认信号线接到正确引脚 |\n| 开门角度不对 | 调整角度值 | 根据实际门锁调整 |\n| 想加密码备用 | 添加按键输入 | 人脸失败时可输入密码 |\n\n---\n\n### 步骤3：硬件搭建（20分钟）\n\n`#高负荷-产出` `#IFC-即时`\n\n**教师话术**\n> \"今天的硬件连接：\n>\n> **舵机接线**：\n> ```\n> 红线（VCC）→ 5V\n> 棕线（GND）→ GND\n> 橙线（信号）→ P0\n> ```\n>\n> **注意事项**：\n> - 舵机需要5V供电，3.3V可能力量不足\n> - 不要强行扭动舵机摆臂\n> - 角度范围通常是0-180度\n>\n> **门锁模型**：\n> - 可以用纸板做一个简易门模型\n> - 舵机摆臂连接门闩\n> - 90度开门，0度关门\"\n\n**禁忌提醒**\n\n❌ **强行扭动舵机**——会损坏内部齿轮\n❌ **舵机角度超范围**——通常是0-180度，超出会卡死\n❌ **忘记初始化位置**——程序开始时先设置初始角度\n\n---\n\n### 步骤4：系统联调（30分钟）\n\n`#高负荷-产出` `#IFC-即时`\n\n**教师话术**\n> \"现在进行完整系统测试：\n>\n> **测试步骤**：\n> 1. 先测试舵机单独工作\n> 2. 再测试摄像头和人脸比对\n> 3. 最后联调整个系统\n>\n> **调试技巧**：\n> ```python\n> # 单独测试舵机\n> servo.write_angle(0)\n> time.sleep(1)\n> servo.write_angle(90)\n> time.sleep(1)\n> servo.write_angle(0)\n> ```\n>\n> **常见问题**：\n> - 舵机抖动：可能是供电不足\n> - 识别不准：调整阈值或重拍模板\n> - 反应慢：减少图像处理的分辨率\"\n\n**变体示例**\n\n| 学生情况 | 调整方案 | 说明 |\n|----------|----------|------|\n| 系统反应慢 | 降低分辨率 | 用更小的图像进行比对 |\n| 想加语音提示 | 使用蜂鸣器 | 匹配成功时发出提示音 |\n| 想记录访客 | 保存照片 | 每次识别时保存当前帧 |\n\n---\n\n### 步骤5：成果展示（10分钟）\n\n`#低负荷-热身` `#IFC-复盘`\n\n**教师话术**\n> \"谁的智能门禁做好了？演示一下刷脸开门！\n>\n> **思考**：\n> - 这个系统还有什么可以改进的地方？\n> - 真正的人脸识别系统是怎么做的？\n> - 如何防止用照片欺骗系统？\"\n\n---"
    },
    {
      "title": "核心知识点",
      "content": "- 舵机控制：`Servo(pin).write_angle(angle)`\n- 系统集成：AI判断 + 硬件控制\n- 完整流程：采集 → 处理 → 判断 → 执行\n\n---"
    },
    {
      "title": "底层逻辑",
      "content": "- **AI+IoT融合**：软件智能 + 硬件执行\n- **系统工程**：多个模块协同工作\n- **人机交互**：视觉反馈（RGB灯）+ 物理反馈（开门）\n\n---\n\n`#执行层` `#测评项`\n[UID: PYAI-14-08-001]\n\n---\n\n[上一课](PYAI-1-4-07_智能门禁2.md) | [返回模块](_模块概览.md) | [下一课](PYAI-1-4-09_音强流水灯.md)"
    }
  ],
  "full_content": "# [PYAI-1-4-08] 智能门禁(3) - 刷脸开门\n\n> **模块**：L1-M4 智能硬件\n> **认知负荷**：高\n> **核心技能**：舵机控制Servo、系统集成\n> **UID**：PYAI-14-08-001\n\n---\n\n## 课程基本信息\n\n| 项目 | 内容 |\n|------|------|\n| **课程编号** | PYAI-1-4-08 |\n| **课程名称** | 智能门禁(3) - 刷脸开门 |\n| **认知负荷** | 高 |\n| **核心技能** | 舵机控制Servo、系统集成 |\n| **课时** | 90分钟 |\n| **系列** | 智能门禁三部曲（3/3） |\n\n---\n\n## 详细教学流程\n\n### 步骤1：课程回顾（5分钟）\n\n`#低负荷-热身` `#IFC-预防`\n\n**教师话术**\n> \"前两节课我们学会了摄像头采集和人脸比对。今天是最后一步——把AI和硬件连接起来，实现真正的刷脸开门！\"\n\n---\n\n### 步骤2：知识讲解（15分钟）\n\n`#中负荷-操练` `#IFC-即时`\n\n**教师话术**\n> \"**舵机**是一种可以精确控制角度的电机：\n>\n> - 控制范围：0-180度\n> - 用于：门锁、机械臂、云台等\n>\n> **舵机控制原理**：\n> ```python\n> from mpython import *\n>\n> # 舵机连接到P0引脚\n> servo = Servo(Pin.P0)\n>\n> # 控制角度\n> servo.write_angle(0)    # 转到0度（关门）\n> servo.write_angle(90)   # 转到90度（开门）\n> servo.write_angle(180)  # 转到180度\n> ```\n>\n> **系统集成流程**：\n> ```\n> 摄像头采集 → 人脸比对 → 相似度判断 → 舵机控制\n>      ↓            ↓           ↓           ↓\n>    frame      similarity   > 0.8?     开门/拒绝\n> ```\"\n\n**核心代码模式**\n\n```python\nimport cv2\nfrom mpython import *\nimport time\n\n# 初始化舵机\nservo = Servo(Pin.P0)\nservo.write_angle(0)  # 初始位置（关门）\n\n# 加载人脸模板\ntemplate = cv2.imread('my_face.jpg', cv2.IMREAD_GRAYSCALE)\ntemplate = cv2.resize(template, (100, 100))\n\n# 打开摄像头\ncap = cv2.VideoCapture(0)\n\n# 匹配阈值\nTHRESHOLD = 0.8\n\nwhile True:\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # 转灰度并调整大小\n    gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)\n    gray_resized = cv2.resize(gray, (100, 100))\n\n    # 计算相似度\n    result = cv2.matchTemplate(gray_resized, template, cv2.TM_CCOEFF_NORMED)\n    similarity = result[0][0]\n\n    # 判断并控制舵机\n    if similarity > THRESHOLD:\n        print(f'匹配成功！相似度: {similarity:.2f}')\n        servo.write_angle(90)  # 开门\n        rgb.fill((0, 255, 0))  # 绿灯\n        rgb.write()\n        time.sleep(3)          # 保持3秒\n        servo.write_angle(0)   # 关门\n        rgb.fill((0, 0, 0))\n        rgb.write()\n    else:\n        rgb.fill((255, 0, 0))  # 红灯\n        rgb.write()\n\n    # 显示画面\n    cv2.imshow('Smart Door', frame)\n    if cv2.waitKey(1) & 0xFF == ord('q'):\n        break\n\ncap.release()\ncv2.destroyAllWindows()\n```\n\n**变体示例**\n\n| 学生情况 | 调整方案 | 说明 |\n|----------|----------|------|\n| 舵机不动 | 检查接线 | 确认信号线接到正确引脚 |\n| 开门角度不对 | 调整角度值 | 根据实际门锁调整 |\n| 想加密码备用 | 添加按键输入 | 人脸失败时可输入密码 |\n\n---\n\n### 步骤3：硬件搭建（20分钟）\n\n`#高负荷-产出` `#IFC-即时`\n\n**教师话术**\n> \"今天的硬件连接：\n>\n> **舵机接线**：\n> ```\n> 红线（VCC）→ 5V\n> 棕线（GND）→ GND\n> 橙线（信号）→ P0\n> ```\n>\n> **注意事项**：\n> - 舵机需要5V供电，3.3V可能力量不足\n> - 不要强行扭动舵机摆臂\n> - 角度范围通常是0-180度\n>\n> **门锁模型**：\n> - 可以用纸板做一个简易门模型\n> - 舵机摆臂连接门闩\n> - 90度开门，0度关门\"\n\n**禁忌提醒**\n\n❌ **强行扭动舵机**——会损坏内部齿轮\n❌ **舵机角度超范围**——通常是0-180度，超出会卡死\n❌ **忘记初始化位置**——程序开始时先设置初始角度\n\n---\n\n### 步骤4：系统联调（30分钟）\n\n`#高负荷-产出` `#IFC-即时`\n\n**教师话术**\n> \"现在进行完整系统测试：\n>\n> **测试步骤**：\n> 1. 先测试舵机单独工作\n> 2. 再测试摄像头和人脸比对\n> 3. 最后联调整个系统\n>\n> **调试技巧**：\n> ```python\n> # 单独测试舵机\n> servo.write_angle(0)\n> time.sleep(1)\n> servo.write_angle(90)\n> time.sleep(1)\n> servo.write_angle(0)\n> ```\n>\n> **常见问题**：\n> - 舵机抖动：可能是供电不足\n> - 识别不准：调整阈值或重拍模板\n> - 反应慢：减少图像处理的分辨率\"\n\n**变体示例**\n\n| 学生情况 | 调整方案 | 说明 |\n|----------|----------|------|\n| 系统反应慢 | 降低分辨率 | 用更小的图像进行比对 |\n| 想加语音提示 | 使用蜂鸣器 | 匹配成功时发出提示音 |\n| 想记录访客 | 保存照片 | 每次识别时保存当前帧 |\n\n---\n\n### 步骤5：成果展示（10分钟）\n\n`#低负荷-热身` `#IFC-复盘`\n\n**教师话术**\n> \"谁的智能门禁做好了？演示一下刷脸开门！\n>\n> **思考**：\n> - 这个系统还有什么可以改进的地方？\n> - 真正的人脸识别系统是怎么做的？\n> - 如何防止用照片欺骗系统？\"\n\n---\n\n## 核心知识点\n\n- 舵机控制：`Servo(pin).write_angle(angle)`\n- 系统集成：AI判断 + 硬件控制\n- 完整流程：采集 → 处理 → 判断 → 执行\n\n---\n\n## 底层逻辑\n\n- **AI+IoT融合**：软件智能 + 硬件执行\n- **系统工程**：多个模块协同工作\n- **人机交互**：视觉反馈（RGB灯）+ 物理反馈（开门）\n\n---\n\n`#执行层` `#测评项`\n[UID: PYAI-14-08-001]\n\n---\n\n[上一课](PYAI-1-4-07_智能门禁2.md) | [返回模块](_模块概览.md) | [下一课](PYAI-1-4-09_音强流水灯.md)\n"
}