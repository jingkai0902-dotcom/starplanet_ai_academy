{
  "title": "常见故障排查",
  "source": "C:\\Users\\Frank.J\\starplanet_ai_academy\\知识库\\02_知识点数据库\\硬件知识库\\常见故障排查.md",
  "sections": [
    {
      "title": "一、ESP32开发板问题",
      "content": "### 1.1 无法连接/识别\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 电脑无法识别ESP32 | USB线只能充电 | 更换支持数据传输的USB线 |\n| 串口被占用 | 其他程序占用 | 关闭其他串口软件，重启IDE |\n| 驱动未安装 | 缺少CH340/CP2102驱动 | 安装对应USB转串口驱动 |\n| 开发板损坏 | 短路或过压 | 更换开发板 |\n\n### 1.2 代码上传失败\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 上传超时 | 未进入下载模式 | 按住BOOT键再点上传 |\n| 端口错误 | 选错COM口 | 在设备管理器确认正确端口 |\n| 权限问题 | 端口被占用 | 关闭其他程序，重启电脑 |\n\n### 1.3 程序运行异常\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 程序不运行 | boot.py有错误 | 删除boot.py或修复错误 |\n| 反复重启 | 代码死循环无延时 | 添加time.sleep() |\n| 内存不足 | 程序太大 | 优化代码，减少变量 |\n\n---"
    },
    {
      "title": "二、LED相关问题",
      "content": "### 2.1 LED不亮\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 完全不亮 | 引脚配置错误 | 检查Pin号和OUT模式 |\n| 完全不亮 | 接线错误 | 检查VCC/GND/信号线 |\n| 完全不亮 | LED损坏 | 更换LED |\n| 亮度很暗 | 电压不足 | 检查电源电压 |\n\n### 2.2 NeoPixel灯带问题\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 灯带不亮 | 未调用write() | 每次修改后调用strip.write() |\n| 灯带不亮 | 未共地 | 连接ESP32和外部电源的GND |\n| 灯带不亮 | 电源不足 | 使用外部5V电源 |\n| 颜色错乱 | 灯珠数量设置错误 | 检查num参数 |\n| 部分灯不亮 | 灯珠损坏 | 更换灯带 |\n\n**代码检查**\n```python\n# ✅ 正确\nstrip.fill((255, 0, 0))\nstrip.write()  # 必须调用！\n\n# ❌ 错误 - 忘记write()\nstrip.fill((255, 0, 0))\n# 灯带不会更新\n```\n\n---"
    },
    {
      "title": "三、传感器问题",
      "content": "### 3.1 DHT11温湿度传感器\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 读数为None | 未调用measure() | 先调用dht.measure() |\n| 读数不更新 | 读取间隔太短 | 两次读取间隔≥1秒 |\n| 数据异常 | 接线错误 | 检查DATA引脚连接 |\n\n**代码检查**\n```python\n# ✅ 正确\ndht.measure()  # 必须先调用！\ntemp = dht.temperature\ntime.sleep(1)  # 等待1秒再读取\n\n# ❌ 错误 - 忘记measure()\ntemp = dht.temperature  # 数据不会更新\n```\n\n### 3.2 HC-SR04超声波传感器\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 读数为0 | 电压不足 | 确保使用5V供电 |\n| 读数不稳定 | 测量角度问题 | 传感器正对目标物体 |\n| 读数异常 | Trig/Echo接反 | 检查引脚连接 |\n| 超出范围 | 距离<2cm或>400cm | 调整测量距离 |\n\n### 3.3 MQ-2B气体传感器\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 读数不准 | 未预热 | 通电预热1-2分钟 |\n| 读数为0 | 电压不足 | 确保使用5V供电 |\n| 读数一直很高 | 环境有气体 | 通风后再测试 |\n\n### 3.4 土壤湿度传感器\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 读数不稳定 | 探针未完全插入 | 探针要完全插入土壤 |\n| 读数异常 | 探针腐蚀 | 清洁或更换��针 |\n| 读数一直很高 | 土壤太干 | 正常现象，需要浇水 |\n\n### 3.5 光线传感器\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 读数不变 | 传感器被遮挡 | 检查传感器位置 |\n| 读数异常 | 直射光干扰 | 避免灯光直射传感器 |\n\n---"
    },
    {
      "title": "四、执行器问题",
      "content": "### 4.1 舵机问题\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 舵机不转 | 电压不足 | 确保使用5V供电 |\n| 舵机抖动 | 角度超出范围 | 限制在0-180度 |\n| 舵机卡死 | 齿轮损坏(扫齿) | 更换舵机 |\n| 角度不准 | 校准问题 | 重新校准0度位置 |\n\n**⚠️ 禁忌提醒**\n- 绝对不要手动强行扭动舵机！\n- 会导致内部齿轮损坏（扫齿）\n\n### 4.2 电机/水泵问题\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 电机不转 | 直接接ESP32 | 必须通过继电器或驱动板 |\n| 电机转速慢 | 电压不足 | 使用外部电源 |\n| 水泵不工作 | 继电器未吸合 | 检查继电器控制信号 |\n| 水泵空转 | 水管无水 | 确保水管有水 |\n\n### 4.3 蜂鸣器问题\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 蜂鸣器不响 | 接线错误 | 检查VCC/GND/信号线 |\n| 声音很小 | 电压不足 | 检查电源电压 |\n| 无法变调 | 使用了有源蜂鸣器 | 有源蜂鸣器只能发固定音调 |\n\n---"
    },
    {
      "title": "五、通信问题",
      "content": "### 5.1 串口通信问题\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 无数据 | TX/RX接反 | 交换TX和RX连接 |\n| 乱码 | 波特率不匹配 | 两端使用相同波特率 |\n| 数据丢失 | 未共地 | 连接两设备的GND |\n\n### 5.2 I2C通信问题\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 设备无响应 | 地址错误 | 扫描I2C地址 |\n| 设备无响应 | SCL/SDA接反 | 检查时钟线和数据线 |\n| 通信不稳定 | 线路太长 | 缩短连接线长度 |\n\n**I2C地址扫描代码**\n```python\nfrom machine import I2C, Pin\ni2c = I2C(0, scl=Pin(22), sda=Pin(21))\ndevices = i2c.scan()\nprint(f\"发现设备: {[hex(d) for d in devices]}\")\n```\n\n---"
    },
    {
      "title": "六、摄像头问题",
      "content": "### 6.1 OpenCV摄像头问题\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 无法打开摄像头 | 摄像头被占用 | 关闭其他使用摄像头的程序 |\n| 无法打开摄像头 | 设备号错误 | 尝试cv2.VideoCapture(0)或(1) |\n| 画面卡顿 | 分辨率太高 | 降低分辨率 |\n| 程序退出后摄像头仍占用 | 未释放资源 | 确保调用cap.release() |\n\n**代码检查**\n```python\n# ✅ 正确 - 使用try-finally确保释放\ncap = cv2.VideoCapture(0)\ntry:\n    while True:\n        ret, frame = cap.read()\n        if not ret:\n            break\n        # 处理帧...\nfinally:\n    cap.release()  # 必须释放！\n    cv2.destroyAllWindows()\n\n# ❌ 错误 - 忘记释放\ncap = cv2.VideoCapture(0)\n# 程序结束后摄像头仍被占用\n```\n\n---"
    },
    {
      "title": "七、电源问题",
      "content": "### 7.1 供电不足\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 设备工作不稳定 | USB供电不足 | 使用外部电源 |\n| 多设备同时工作异常 | 电流超限 | 分开供电 |\n| 开发板反复重启 | 电压波动 | 使用稳压电源 |\n\n### 7.2 电压不匹配\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 设备烧毁 | 5V接到3.3V设备 | 确认设备电压需求 |\n| 设备不工作 | 3.3V接到5V设备 | 使用正确电压供电 |\n\n---"
    },
    {
      "title": "八、软件问题",
      "content": "### 8.1 库导入错误\n\n| 错误信息 | 原因 | 解决方法 |\n|---------|------|---------|\n| ModuleNotFoundError | 库未安装 | pip install 库名 |\n| ImportError | 导入路径错误 | 检查from/import语句 |\n| AttributeError | 类/方法名错误 | 检查API文档 |\n\n### 8.2 常见代码错误\n\n| 错误 | 原因 | 解决方法 |\n|------|------|---------|\n| Pin号错误 | 使用了不存在的引脚 | 查阅ESP32引脚图 |\n| ADC读数为0 | 未设置量程 | 添加atten(ADC.ATTN_11DB) |\n| PWM不工作 | 频率设置错误 | 检查freq参数 |\n\n---"
    },
    {
      "title": "九、快速排查流程",
      "content": "### 9.1 设备不工作排查流程\n\n```\n1. 检查电源\n   ├─ VCC/GND是否正确连接？\n   ├─ 电压是否匹配（3.3V/5V）？\n   └─ 电源是否稳定？\n\n2. 检查接线\n   ├─ 信号线是否连接正确引脚？\n   ├─ 是否有松动？\n   └─ 是否有短路？\n\n3. 检查代码\n   ├─ 引脚号是否正确？\n   ├─ 是否调用了必要的方法？\n   └─ 是否有语法错误？\n\n4. 检查硬件\n   ├─ 设备是否损坏？\n   └─ 更换设备测试\n```\n\n### 9.2 通信问题排查流程\n\n```\n1. 检查物理连接\n   ├─ 线路是否连接？\n   ├─ TX/RX是否交叉？\n   └─ 是否共地？\n\n2. 检查参数设置\n   ├─ 波特率是否一致？\n   ├─ I2C地址是否正确？\n   └─ 引脚配置是否正确？\n\n3. 使用测试代码\n   ├─ 发送简单数据测试\n   └─ 扫描I2C设备\n```\n\n---"
    },
    {
      "title": "十、预防措施",
      "content": "### 10.1 接线前检查\n\n| 检查项 | 说明 |\n|--------|------|\n| ☐ 断电操作 | 接线前必须断开USB |\n| ☐ 电压确认 | 确认设备电压需求 |\n| ☐ 引脚确认 | 查阅引脚图确认连接 |\n| ☐ 绝缘表面 | 开发板放在绝缘表面 |\n\n### 10.2 代码编写规范\n\n| 规范 | 说明 |\n|------|------|\n| 资源释放 | 程序结束前释放摄像头等资源 |\n| 延时添加 | 循环中添加适当延时 |\n| 错误处理 | 添加try-except处理异常 |\n| 范围检查 | 检查数值是否在有效范围 |\n\n---\n\n**维护者**：知识库管理员\n**数据来源**：萃取报告/PythonAI/、萃取报告/STEM/\n**整合原则**：基于现有萃取报告，不压缩删减"
    }
  ],
  "full_content": "# 常见故障排查\n\n> **用途**：跨课程硬件故障排查指南\n> **更新日期**：2026-02-10\n> **数据来源**：萃取报告/PythonAI/、萃取报告/STEM/\n> **整合原则**：基于现有萃取报告，不压缩删减\n\n---\n\n## 一、ESP32开发板问题\n\n### 1.1 无法连接/识别\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 电脑无法识别ESP32 | USB线只能充电 | 更换支持数据传输的USB线 |\n| 串口被占用 | 其他程序占用 | 关闭其他串口软件，重启IDE |\n| 驱动未安装 | 缺少CH340/CP2102驱动 | 安装对应USB转串口驱动 |\n| 开发板损坏 | 短路或过压 | 更换开发板 |\n\n### 1.2 代码上传失败\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 上传超时 | 未进入下载模式 | 按住BOOT键再点上传 |\n| 端口错误 | 选错COM口 | 在设备管理器确认正确端口 |\n| 权限问题 | 端口被占用 | 关闭其他程序，重启电脑 |\n\n### 1.3 程序运行异常\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 程序不运行 | boot.py有错误 | 删除boot.py或修复错误 |\n| 反复重启 | 代码死循环无延时 | 添加time.sleep() |\n| 内存不足 | 程序太大 | 优化代码，减少变量 |\n\n---\n\n## 二、LED相关问题\n\n### 2.1 LED不亮\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 完全不亮 | 引脚配置错误 | 检查Pin号和OUT模式 |\n| 完全不亮 | 接线错误 | 检查VCC/GND/信号线 |\n| 完全不亮 | LED损坏 | 更换LED |\n| 亮度很暗 | 电压不足 | 检查电源电压 |\n\n### 2.2 NeoPixel灯带问题\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 灯带不亮 | 未调用write() | 每次修改后调用strip.write() |\n| 灯带不亮 | 未共地 | 连接ESP32和外部电源的GND |\n| 灯带不亮 | 电源不足 | 使用外部5V电源 |\n| 颜色错乱 | 灯珠数量设置错误 | 检查num参数 |\n| 部分灯不亮 | 灯珠损坏 | 更换灯带 |\n\n**代码检查**\n```python\n# ✅ 正确\nstrip.fill((255, 0, 0))\nstrip.write()  # 必须调用！\n\n# ❌ 错误 - 忘记write()\nstrip.fill((255, 0, 0))\n# 灯带不会更新\n```\n\n---\n\n## 三、传感器问题\n\n### 3.1 DHT11温湿度传感器\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 读数为None | 未调用measure() | 先调用dht.measure() |\n| 读数不更新 | 读取间隔太短 | 两次读取间隔≥1秒 |\n| 数据异常 | 接线错误 | 检查DATA引脚连接 |\n\n**代码检查**\n```python\n# ✅ 正确\ndht.measure()  # 必须先调用！\ntemp = dht.temperature\ntime.sleep(1)  # 等待1秒再读取\n\n# ❌ 错误 - 忘记measure()\ntemp = dht.temperature  # 数据不会更新\n```\n\n### 3.2 HC-SR04超声波传感器\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 读数为0 | 电压不足 | 确保使用5V供电 |\n| 读数不稳定 | 测量角度问题 | 传感器正对目标物体 |\n| 读数异常 | Trig/Echo接反 | 检查引脚连接 |\n| 超出范围 | 距离<2cm或>400cm | 调整测量距离 |\n\n### 3.3 MQ-2B气体传感器\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 读数不准 | 未预热 | 通电预热1-2分钟 |\n| 读数为0 | 电压不足 | 确保使用5V供电 |\n| 读数一直很高 | 环境有气体 | 通风后再测试 |\n\n### 3.4 土壤湿度传感器\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 读数不稳定 | 探针未完全插入 | 探针要完全插入土壤 |\n| 读数异常 | 探针腐蚀 | 清洁或更换��针 |\n| 读数一直很高 | 土壤太干 | 正常现象，需要浇水 |\n\n### 3.5 光线传感器\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 读数不变 | 传感器被遮挡 | 检查传感器位置 |\n| 读数异常 | 直射光干扰 | 避免灯光直射传感器 |\n\n---\n\n## 四、执行器问题\n\n### 4.1 舵机问题\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 舵机不转 | 电压不足 | 确保使用5V供电 |\n| 舵机抖动 | 角度超出范围 | 限制在0-180度 |\n| 舵机卡死 | 齿轮损坏(扫齿) | 更换舵机 |\n| 角度不准 | 校准问题 | 重新校准0度位置 |\n\n**⚠️ 禁忌提醒**\n- 绝对不要手动强行扭动舵机！\n- 会导致内部齿轮损坏（扫齿）\n\n### 4.2 电机/水泵问题\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 电机不转 | 直接接ESP32 | 必须通过继电器或驱动板 |\n| 电机转速慢 | 电压不足 | 使用外部电源 |\n| 水泵不工作 | 继电器未吸合 | 检查继电器控制信号 |\n| 水泵空转 | 水管无水 | 确保水管有水 |\n\n### 4.3 蜂鸣器问题\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 蜂鸣器不响 | 接线错误 | 检查VCC/GND/信号线 |\n| 声音很小 | 电压不足 | 检查电源电压 |\n| 无法变调 | 使用了有源蜂鸣器 | 有源蜂鸣器只能发固定音调 |\n\n---\n\n## 五、通信问题\n\n### 5.1 串口通信问题\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 无数据 | TX/RX接反 | 交换TX和RX连接 |\n| 乱码 | 波特率不匹配 | 两端使用相同波特率 |\n| 数据丢失 | 未共地 | 连接两设备的GND |\n\n### 5.2 I2C通信问题\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 设备无响应 | 地址错误 | 扫描I2C地址 |\n| 设备无响应 | SCL/SDA接反 | 检查时钟线和数据线 |\n| 通信不稳定 | 线路太长 | 缩短连接线长度 |\n\n**I2C地址扫描代码**\n```python\nfrom machine import I2C, Pin\ni2c = I2C(0, scl=Pin(22), sda=Pin(21))\ndevices = i2c.scan()\nprint(f\"发现设备: {[hex(d) for d in devices]}\")\n```\n\n---\n\n## 六、摄像头问题\n\n### 6.1 OpenCV摄像头问题\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 无法打开摄像头 | 摄像头被占用 | 关闭其他使用摄像头的程序 |\n| 无法打开摄像头 | 设备号错误 | 尝试cv2.VideoCapture(0)或(1) |\n| 画面卡顿 | 分辨率太高 | 降低分辨率 |\n| 程序退出后摄像头仍占用 | 未释放资源 | 确保调用cap.release() |\n\n**代码检查**\n```python\n# ✅ 正确 - 使用try-finally确保释放\ncap = cv2.VideoCapture(0)\ntry:\n    while True:\n        ret, frame = cap.read()\n        if not ret:\n            break\n        # 处理帧...\nfinally:\n    cap.release()  # 必须释放！\n    cv2.destroyAllWindows()\n\n# ❌ 错误 - 忘记释放\ncap = cv2.VideoCapture(0)\n# 程序结束后摄像头仍被占用\n```\n\n---\n\n## 七、电源问题\n\n### 7.1 供电不足\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 设备工作不稳定 | USB供电不足 | 使用外部电源 |\n| 多设备同时工作异常 | 电流超限 | 分开供电 |\n| 开发板反复重启 | 电压波动 | 使用稳压电源 |\n\n### 7.2 电压不匹配\n\n| 现象 | 可能原因 | 解决方法 |\n|------|---------|---------|\n| 设备烧毁 | 5V接到3.3V设备 | 确认设备电压需求 |\n| 设备不工作 | 3.3V接到5V设备 | 使用正确电压供电 |\n\n---\n\n## 八、软件问题\n\n### 8.1 库导入错误\n\n| 错误信息 | 原因 | 解决方法 |\n|---------|------|---------|\n| ModuleNotFoundError | 库未安装 | pip install 库名 |\n| ImportError | 导入路径错误 | 检查from/import语句 |\n| AttributeError | 类/方法名错误 | 检查API文档 |\n\n### 8.2 常见代码错误\n\n| 错误 | 原因 | 解决方法 |\n|------|------|---------|\n| Pin号错误 | 使用了不存在的引脚 | 查阅ESP32引脚图 |\n| ADC读数为0 | 未设置量程 | 添加atten(ADC.ATTN_11DB) |\n| PWM不工作 | 频率设置错误 | 检查freq参数 |\n\n---\n\n## 九、快速排查流程\n\n### 9.1 设备不工作排查流程\n\n```\n1. 检查电源\n   ├─ VCC/GND是否正确连接？\n   ├─ 电压是否匹配（3.3V/5V）？\n   └─ 电源是否稳定？\n\n2. 检查接线\n   ├─ 信号线是否连接正确引脚？\n   ├─ 是否有松动？\n   └─ 是否有短路？\n\n3. 检查代码\n   ├─ 引脚号是否正确？\n   ├─ 是否调用了必要的方法？\n   └─ 是否有语法错误？\n\n4. 检查硬件\n   ├─ 设备是否损坏？\n   └─ 更换设备测试\n```\n\n### 9.2 通信问题排查流程\n\n```\n1. 检查物理连接\n   ├─ 线路是否连接？\n   ├─ TX/RX是否交叉？\n   └─ 是否共地？\n\n2. 检查参数设置\n   ├─ 波特率是否一致？\n   ├─ I2C地址是否正确？\n   └─ 引脚配置是否正确？\n\n3. 使用测试代码\n   ├─ 发送简单数据测试\n   └─ 扫描I2C设备\n```\n\n---\n\n## 十、预防措施\n\n### 10.1 接线前检查\n\n| 检查项 | 说明 |\n|--------|------|\n| ☐ 断电操作 | 接线前必须断开USB |\n| ☐ 电压确认 | 确认设备电压需求 |\n| ☐ 引脚确认 | 查阅引脚图确认连接 |\n| ☐ 绝缘表面 | 开发板放在绝缘表面 |\n\n### 10.2 代码编写规范\n\n| 规范 | 说明 |\n|------|------|\n| 资源释放 | 程序结束前释放摄像头等资源 |\n| 延时添加 | 循环中添加适当延时 |\n| 错误处理 | 添加try-except处理异常 |\n| 范围检查 | 检查数值是否在有效范围 |\n\n---\n\n**维护者**：知识库管理员\n**数据来源**：萃取报告/PythonAI/、萃取报告/STEM/\n**整合原则**：基于现有萃取报告，不压缩删减\n"
}